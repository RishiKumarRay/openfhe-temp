<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PALISADE Lattice Crypto Library: lbcrypto::LPAlgorithmPREBFVrnsB&lt; Element &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PALISADE Lattice Crypto Library
   &#160;<span id="projectnumber">1.11.5</span>
   </div>
   <div id="projectbrief">A lattice crypto library for software engineers by software engineers.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelbcrypto.html">lbcrypto</a></li><li class="navelem"><a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html">LPAlgorithmPREBFVrnsB</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">lbcrypto::LPAlgorithmPREBFVrnsB&lt; Element &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>PRE algorithms implementation for BFVrnsB.  
 <a href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="bfvrnsB_8h_source.html">bfvrnsB.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for lbcrypto::LPAlgorithmPREBFVrnsB&lt; Element &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classlbcrypto_1_1LPAlgorithmPREBFVrnsB__inherit__graph.png" border="0" usemap="#lbcrypto_1_1LPAlgorithmPREBFVrnsB_3_01Element_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="lbcrypto_1_1LPAlgorithmPREBFVrnsB_3_01Element_01_4_inherit__map" id="lbcrypto_1_1LPAlgorithmPREBFVrnsB_3_01Element_01_4_inherit__map">
<area shape="rect" title="PRE algorithms implementation for BFVrnsB." alt="" coords="5,184,237,225"/>
<area shape="rect" href="classlbcrypto_1_1LPAlgorithmPREBFV.html" title="PRE scheme based on BFV. This functionality is currently DISABLED in LPPublicKeyEncryptionSchemeBFV b..." alt="" coords="15,95,227,136"/>
<area shape="rect" href="classlbcrypto_1_1LPPREAlgorithm.html" title="Abstract interface class for LBC PRE algorithms." alt="" coords="28,5,215,47"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for lbcrypto::LPAlgorithmPREBFVrnsB&lt; Element &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classlbcrypto_1_1LPAlgorithmPREBFVrnsB__coll__graph.png" border="0" usemap="#lbcrypto_1_1LPAlgorithmPREBFVrnsB_3_01Element_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="lbcrypto_1_1LPAlgorithmPREBFVrnsB_3_01Element_01_4_coll__map" id="lbcrypto_1_1LPAlgorithmPREBFVrnsB_3_01Element_01_4_coll__map">
<area shape="rect" title="PRE algorithms implementation for BFVrnsB." alt="" coords="5,184,237,225"/>
<area shape="rect" href="classlbcrypto_1_1LPAlgorithmPREBFV.html" title="PRE scheme based on BFV. This functionality is currently DISABLED in LPPublicKeyEncryptionSchemeBFV b..." alt="" coords="15,95,227,136"/>
<area shape="rect" href="classlbcrypto_1_1LPPREAlgorithm.html" title="Abstract interface class for LBC PRE algorithms." alt="" coords="28,5,215,47"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a231784dc46ba14858c5ab5b8f8a5d3be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html#a231784dc46ba14858c5ab5b8f8a5d3be">LPAlgorithmPREBFVrnsB</a> ()</td></tr>
<tr class="separator:a231784dc46ba14858c5ab5b8f8a5d3be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ad983fe32a1fe48cf863b9fc8b46e98"><td class="memItemLeft" align="right" valign="top">LPEvalKey&lt; Element &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html#a6ad983fe32a1fe48cf863b9fc8b46e98">ReKeyGen</a> (const LPPublicKey&lt; Element &gt; newKey, const LPPrivateKey&lt; Element &gt; oldKey) const override</td></tr>
<tr class="separator:a6ad983fe32a1fe48cf863b9fc8b46e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a273142dcff4596b866303f5a7050d093"><td class="memItemLeft" align="right" valign="top">Ciphertext&lt; Element &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html#a273142dcff4596b866303f5a7050d093">ReEncrypt</a> (const LPEvalKey&lt; Element &gt; ek, ConstCiphertext&lt; Element &gt; ciphertext, const LPPublicKey&lt; Element &gt; publicKey=nullptr) const override</td></tr>
<tr class="separator:a273142dcff4596b866303f5a7050d093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a817bfa4f71412eb4002478101b296372"><td class="memItemLeft" align="right" valign="top"><a id="a817bfa4f71412eb4002478101b296372"></a>
LPEvalKey&lt; <a class="el" href="classlbcrypto_1_1HexlDCRTPoly.html">DCRTPoly</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ReKeyGen</b> (const LPPublicKey&lt; <a class="el" href="classlbcrypto_1_1HexlDCRTPoly.html">DCRTPoly</a> &gt; newPK, const LPPrivateKey&lt; <a class="el" href="classlbcrypto_1_1HexlDCRTPoly.html">DCRTPoly</a> &gt; origPrivateKey) const</td></tr>
<tr class="separator:a817bfa4f71412eb4002478101b296372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1682d3d429f3e9c1fdba06ff3757d690"><td class="memItemLeft" align="right" valign="top"><a id="a1682d3d429f3e9c1fdba06ff3757d690"></a>
Ciphertext&lt; <a class="el" href="classlbcrypto_1_1HexlDCRTPoly.html">DCRTPoly</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ReEncrypt</b> (const LPEvalKey&lt; <a class="el" href="classlbcrypto_1_1HexlDCRTPoly.html">DCRTPoly</a> &gt; ek, ConstCiphertext&lt; <a class="el" href="classlbcrypto_1_1HexlDCRTPoly.html">DCRTPoly</a> &gt; ciphertext, const LPPublicKey&lt; <a class="el" href="classlbcrypto_1_1HexlDCRTPoly.html">DCRTPoly</a> &gt; publicKey) const</td></tr>
<tr class="separator:a1682d3d429f3e9c1fdba06ff3757d690"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classlbcrypto_1_1LPAlgorithmPREBFV"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classlbcrypto_1_1LPAlgorithmPREBFV')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFV.html">lbcrypto::LPAlgorithmPREBFV&lt; Element &gt;</a></td></tr>
<tr class="memitem:a038ec42762e3fbcd4eaa91b1f8d5d305 inherit pub_methods_classlbcrypto_1_1LPAlgorithmPREBFV"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFV.html#a038ec42762e3fbcd4eaa91b1f8d5d305">LPAlgorithmPREBFV</a> ()</td></tr>
<tr class="separator:a038ec42762e3fbcd4eaa91b1f8d5d305 inherit pub_methods_classlbcrypto_1_1LPAlgorithmPREBFV"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8abe3a65217240851357425cf5343c44 inherit pub_methods_classlbcrypto_1_1LPAlgorithmPREBFV"><td class="memItemLeft" align="right" valign="top"><a id="a8abe3a65217240851357425cf5343c44"></a>
LPEvalKey&lt; Element &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ReKeyGen</b> (const LPPrivateKey&lt; Element &gt; newKey, const LPPrivateKey&lt; Element &gt; origPrivateKey) const</td></tr>
<tr class="separator:a8abe3a65217240851357425cf5343c44 inherit pub_methods_classlbcrypto_1_1LPAlgorithmPREBFV"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;class Element&gt;<br />
class lbcrypto::LPAlgorithmPREBFVrnsB&lt; Element &gt;</h3>

<p>PRE algorithms implementation for BFVrnsB. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Element</td><td>a ring element. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a231784dc46ba14858c5ab5b8f8a5d3be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a231784dc46ba14858c5ab5b8f8a5d3be">&#9670;&nbsp;</a></span>LPAlgorithmPREBFVrnsB()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Element &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html">lbcrypto::LPAlgorithmPREBFVrnsB</a>&lt; Element &gt;::<a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html">LPAlgorithmPREBFVrnsB</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default constructor </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a273142dcff4596b866303f5a7050d093"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a273142dcff4596b866303f5a7050d093">&#9670;&nbsp;</a></span>ReEncrypt()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Element &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Ciphertext&lt; Element &gt; <a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html">lbcrypto::LPAlgorithmPREBFVrnsB</a>&lt; Element &gt;::ReEncrypt </td>
          <td>(</td>
          <td class="paramtype">const LPEvalKey&lt; Element &gt;&#160;</td>
          <td class="paramname"><em>ek</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstCiphertext&lt; Element &gt;&#160;</td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const LPPublicKey&lt; Element &gt;&#160;</td>
          <td class="paramname"><em>publicKey</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method implements re-encryption using the evaluation key generated by ReKeyGen.</p>
<p>The PRE scheme used can achieve two different levels of security, based on the value supplied in the publicKey argument:</p>
<p>If publicKey is nullptr, the PRE scheme is CPA-secure. If the publicKey of the recipient of the re-encrypted ciphertext is supplied, then the scheme is HRA- secure. Please refer to Cohen, "What about Bob? The
inadequacy of CPA Security for proxy re-encryption", for more information on HRA security.</p>
<p>The tradeoff of going for HRA is twofold: (1) performance is a little worst because we add one additional encryption and homomorphic addition to the result, and (2) more noise is added to the result because of the additional operations - in particular, the extra encryption draws noise from a distribution whose standard deviation is scaled by K, the number of digits in the PRE decomposition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ek</td><td>the evaluation key. </td></tr>
    <tr><td class="paramname">ciphertext</td><td>the input ciphertext. </td></tr>
    <tr><td class="paramname">publicKey</td><td>the public key of the recipient of the re-encrypted ciphertext. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>resulting ciphertext after the re-encryption operation. </dd></dl>

<p>Reimplemented from <a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFV.html#a1d5d832d8d3074785c27a905fd6765ca">lbcrypto::LPAlgorithmPREBFV&lt; Element &gt;</a>.</p>

</div>
</div>
<a id="a6ad983fe32a1fe48cf863b9fc8b46e98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ad983fe32a1fe48cf863b9fc8b46e98">&#9670;&nbsp;</a></span>ReKeyGen()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Element &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LPEvalKey&lt; Element &gt; <a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFVrnsB.html">lbcrypto::LPAlgorithmPREBFVrnsB</a>&lt; Element &gt;::ReKeyGen </td>
          <td>(</td>
          <td class="paramtype">const LPPublicKey&lt; Element &gt;&#160;</td>
          <td class="paramname"><em>newKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const LPPrivateKey&lt; Element &gt;&#160;</td>
          <td class="paramname"><em>oldKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The generation of re-encryption keys is based on the BG-PRE scheme described in Polyakov, et. al., "Fast proxy re-encryption for
publish/subscribe systems".</p>
<p>The above scheme was found to have a weakness in Cohen, "What about Bob?
The inadequacy of CPA Security for proxy re-encryption". Section 5.1 shows an attack where given an original ciphertext c=(c0,c1) and a re-encrypted ciphertext c'=(c'0, c'1), the subscriber (Bob) can compute the secret key of the publisher (Alice).</p>
<p>We fix this vulnerability by making re-encryption keys be encryptions of the s*(2^{i*r}) terms, instead of simple addition as previously defined. This makes retrieving the secret key using the above attack as hard as breaking the RLWE assumption.</p>
<p>Our modification makes the scheme CPA-secure, but does not achieve HRA-security as it was defined in the Cohen paper above. Please look at the ReEncrypt method for an explanation of the two security definitions and how to achieve each in Palisade.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newKey</td><td>public key for the new private key. </td></tr>
    <tr><td class="paramname">oldKey</td><td>original private key used for decryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>evalKey the evaluation key for switching the ciphertext to be decryptable by new private key. </dd></dl>

<p>Reimplemented from <a class="el" href="classlbcrypto_1_1LPAlgorithmPREBFV.html#acce577e9f20ab7e2dd2abc7220ba4c03">lbcrypto::LPAlgorithmPREBFV&lt; Element &gt;</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/pke/include/scheme/bfvrnsb/<a class="el" href="bfvrnsB_8h_source.html">bfvrnsB.h</a></li>
<li>src/pke/lib/scheme/bfvrnsb/bfvrnsB.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 19 2022 20:29:14 for PALISADE Lattice Crypto Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
